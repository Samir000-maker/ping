<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Ping Debug & Keep Alive</title>
  <style>
    #log { font-family: monospace; white-space: pre-wrap; max-height: 320px; overflow:auto; background:#fafafa; padding:8px; border:1px solid #ddd; }
  </style>
</head>
<body>
  <h2>Keep-alive pings (debug)</h2>
  <div id="log"></div>

  <script>
    const LOG = document.getElementById('log');
    const HEALTH_URL = 'https://samir-hgr9.onrender.com/health';

    function now() { return new Date().toISOString(); }
    function write(...args) {
      const line = '[' + now() + '] ' + args.map(a => (typeof a === 'object' ? JSON.stringify(a) : a)).join(' ');
      LOG.textContent += line + '\n';
      LOG.scrollTop = LOG.scrollHeight;
      console.log(...args);
    }

    async function pingOnce() {
      const url = HEALTH_URL + '?t=' + Date.now();
      write('Ping attempt ->', url);
      try {
        const res = await fetch(url, { method: 'GET', cache: 'no-store' });
        write('HTTP', res.status, 'ok=', res.ok);
        const text = await res.text();
        write('Response (truncated):', text.slice(0, 500));
        if (res.ok) {
          write('%cPing success (200)', 'color:green');
        } else {
          write('%cPing failed (non-200)', 'color:orange');
        }
      } catch (err) {
        write('Fetch error:', String(err));
      }
    }

    // First immediate ping
    pingOnce();

    // Use a conservative interval to avoid overloading the free Render instance.
    // Render's free tier can be sensitive to very frequent pings; 5 minutes is safe for monitoring.
    const INTERVAL_MS = 5 * 60 * 1000; // 5 minutes
    setInterval(pingOnce, INTERVAL_MS);
  </script>
</body>
</html>
